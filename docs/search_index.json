[["index.html", "FluvialGeomorph User Manual Preface 0.1 Abstract 0.2 Distribution Statement 0.3 Unit Conversion Factors 0.4 Notation List", " FluvialGeomorph User Manual Michael Dougherty, Geographer, US Army Corps of Engineers, Rock Island District Christopher Haring, Geomorphologist/Research Physical Scientist, Coastal Hydraulics Laboratory, U.S. Army Corps of Engineers 2021-03-25 Preface Funding for development and maintenance of FluvialGeomorph has been provided by the following US Army Corps of Engineers (USACE) programs: Ecosystem Management and Restoration Research Program (EMRRP). Regional Sediment Management Program (RSM) Mississippi River Geomorphology and Potamology Program (MRG&amp;P) Flood Risk Management Program (FRM) Engineering With Nature (EWN) 0.1 Abstract The FluvialGeomorph ArcGIS toolbox provides a set of tools for conducting rapid fluvial geomorphology analysis and assessment. It allows a user to use high resolution, remotely sensed LiDAR (Light Detection and Ranging) terrain data to cost effectively extract stream channel dimensions at fine scale for large spatial extents. More than just documenting a toolbox, this user manual presents an analysis framework that guides GIS analysts with step-by-step instructions through the process of transforming LiDAR data into fluvial geomorphic assessments. These assessments can be used by fluvial geomorphologists and water resource professionals to assess stream conditions and identify problems and opportunities. By organizing several complex datasets into standard reports, the FluvialGeomorph toolbox concisely presents volumes of data in a concise way to aid analysis. 0.2 Distribution Statement Approved for public release; distribution is unlimited 0.3 Unit Conversion Factors Unit Conversion Factors Multiply By To Obtain feet 0.3048 meters miles 1.60934 kilometers square miles 2.58999 square kilometers 0.4 Notation List "],["introduction.html", "Chapter 1 Introduction 1.1 Background 1.2 Objective 1.3 Approach", " Chapter 1 Introduction 1.1 Background The background section defines the problem addressed by the research and its impact on the U.S. Army. It cites related previous studies and explains why the current research is necessary. It also may present other background information that provides essential context for the reader. Examples include the following: controlling regulations or legal requirements prospective users of the report or the technology. hi-res terrain opportunity, but not enough tools historic field survey versus geomorphometric automated methods The purpose of regional curves and why they are important for rapid watershed assessment vison for what the analysis can be used to accomplish 1.2 Objective The objective is a concise statement of what the research is intended to accomplish. Goals * Provide a USACE Planning method for rapid watershed assessments * Develop rapid watershed assessment tools using high resolution terrain data and existing fluvial geomorphic principles * Develop a USACE Ecological Planning model based on rapid watershed assessment metrics to define restoration and mitigation benefits Objectives * Develop a suite of planning analysis tools to rapidly assess and identify sediment sources, pathways, and sinks for watershed analysis. * Use existing geomorphic principles to develop metrics for analyzing LiDAR-derived channel, floodplain, valley, and watershed characteristics. * Develop an approach to relate channel, floodplain, valley, and watershed characteristics to Ecosystem Restoration (ER) habitat evaluation and benefits. 1.3 Approach The approach section explains the research methodology. If the methodology is complex or otherwise warrants a chapter of its own, the approach section may simply cross-reference the reader to the appropriate chapter. "],["install.html", "Chapter 2 Install 2.1 Software Requirements 2.2 Install R 2.3 Install RStudio 2.4 Install TauDEM 2.5 Install ArcGIS Pro 2.6 Install arcgisbinding 2.7 Install FluvialGeomorph 2.8 Install Tutorial Data", " Chapter 2 Install This chapter describes the process for installing and configuring the FluvialGeomorph toolbox and its required software components. 2.1 Software Requirements Here is a summary of the software that must be installed to use the FluvialGeomorph toolbox. The rest of this chapter will describe how to complete these installations. Windows OS (10+ recommended, Server 2019). ArcGIS desktop GIS applications are only provided by ESRI for the Windows platform. R Statistical Computing Language (3.6.3+ recommended) RStudio Desktop (1.3+ recommended) TauDEM (5.3.7+ recommended) ArcGIS Pro (2.6+ recommended) ArcGIS Desktop (10.8+ recommended), optional, limited support FluvialGeomorph toolbox, latest version 2.2 Install R R is a statistical computing environment required to perform calculations and report generation (R Core Team (2020)). Ensure that R is installed. R version 3.6.3 or greater is recommended. Ensure that RTools is installed. You will need either RTools35 for R v3.6.x or RTools40 for R v4.x. RTools is required for compiling R packages from source. It is highly recommended, but not strictly required. Ensure that your RTools installation is on the system PATH (i.e., open a command prompt window, use the path command). If not, set your user environment PATH variable to the appropriate (depending on the R major version) RTools bin directory (e.g., C:\\Rtools\\bin, C:\\rtools40\\usr\\bin). 2.3 Install RStudio Rstudio is an Integrated Development Environment (IDE) for R that streamlines development and troubleshooting. Ensure that Rstudio is installed. RStudio version 1.3 or greater is recommended. RStudio is recommended, but not strictly required. Update your currently installed R packages to the latest version. On the RStudio tools menu, select Check for Package Updates. Click the Select All button and click the Install Updates button. If asked to compile packages from source, select Yes if you installed RTools. 2.4 Install TauDEM TauDEM (Terrain Analysis Using Digital Elevation Models) is a suite of Digital Elevation Model (DEM) tools for the extraction and analysis of hydrologic information from topography as represented by a DEM (Tarboton (1997), Fan et al. (2014), Yldrm et al. (2016)). TauDEM is used for advanced DEM processing and synthetic stream delineation. Install the latest version of TauDEM, v5.3.7. Ensure that TauDEM is on the system PATH. If not, set your user environment PATH variable to the TauDEM executable directory (e.g., C:\\Program Files\\TauDEM\\TauDEM5Exe). 2.5 Install ArcGIS Pro ESRI ArcGIS Pro is the GIS application where the FluvialGeomorph analysis will be performed and where the toolbox will be accessed. Ensure that ArcGIS Pro is installed. ArcGIS Pro version 2.6+ is recommended. 2.5.1 Limited ArcMap support ESRI ArcMap can currently be used to run the FluvialGeomorph toolbox, but use of ArcGIS Pro provides more functionality (e.g., charting, map templates, etc.). As the ArcMap application approaches end of life, it will no longer be supported by the FluvialGeomorph toolbox. As ArcMap is a 32-bit application, some R functions currently do not always perform as expected under 32-bit R. If you expect to get the most out of the FluvialGeomorph toolbox, migrate now to ArcGIS Pro to take advantage of the latest data formats, geoprocessing speed, Python 3, and 64-bit R. 2.6 Install arcgisbinding The ESRI arcgisbinding R package allows ArcGIS Pro and ArcMap to read and write to R sessions. Installing it through ArcGIS Pro also enables it for use in ArcMap as well. See the NEWS for more details on version compatibility for each release. 2.6.1 Install the latest arcgisbinding version In ArcGIS Pro, on the top menu, click Project, and click Options on the left menu. In the Options dialog box, click Geoprocessing on the left menu. On the Geoprocessing page, scroll down to the R-ArcGIS Support section. In the R-ArcGIS Support section, verify the installed R version for ArcGIS to use. Select an R version in the 4.x series. From the Installed arcgisbinding package version: dropdown menu, choose the Check package for updates option. 2.6.2 Download a specific arcgisbinding package version Sometimes the FluvialGeomorph toolbox requires a specific version of the arcgisbinding package. Check the version compatibility matrix in the release notes for guidance. If the FluvialGeomporph toolbox release you are using specifies a particular combination of software versions, please manually download the specified version using these instructions: Navigate to the following URL: https://github.com/R-ArcGIS/r-bridge In the Releases section on the middle-right side of the page, click the + xx releases link. Download the v1.0.1.239 version. This file is named: arcgisbinding_1.0.1.239.zip Note the location of the file you just downloaded. We will use it in a following step. 2.6.3 Install a specific arcgisbinding package version In ArcGIS Pro, on the top menu, click Project, and click Options on the left menu. In the Options dialog box, click Geoprocessing on the left menu. On the Geoprocessing page, scroll down to the R-ArcGIS Support section. In the R-ArcGIS Support section, verify the installed R version for ArcGIS to use. Select an R version in the 3.6.x series. Below the Detected R home directories drop-down menu, you will see the arcgisbinding package section. From the drop-down, choose the Update from file option. Navigate to the arcgisbinding_1.0.1.239.zip file you downloaded in an earlier step and click the OK button. 2.7 Install FluvialGeomorph The code in the FluvialGeomorph-toolbox/ repository contains all of the files needed to use this ArcGIS toolbox. Open a web browser and navigate to https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/. In the Releases section in the upper right side of the page, click the green latest link. On the latest release page, use the Source code (zip) link toward the bottom of the page to download a ZIP archive of the toolbox. Copy the ZIP archive file to your project working directory. If you already have a previous version of the FluvialGeomorph toolbox, delete it now. Unzip the archive file of the latest version to your project folder. In ArcMap or ArcGIS Pro, navigate to the folder where you just unzipped the archive and you are ready to use this ArcGIS toolbox. 2.7.1 Install the FluvialGeomorph R packages In this section we will use the FluvialGeomorph toolbox to install the R packages needed by the toolbox. Ensure that all other R applications (e.g., RGui, RStudio) are closed. In ArcGIS Pro, navigate to the FluvialGeomorph toolbox and add it to your project. In the Install toolset, use the Install R packages tool to install the required R packages. In the tools Messages section, follow the R console output for messages on installation progress. 2.7.2 Troubleshooting This is a list of commonly experienced errors and warnings when installing FluvialGeomorph R packages and their workarounds. Problem: cannot remove prior installation of package '&lt;some package&gt;' Solution: Ensure that all other R applications (e.g., RGui, RStudio) are closed. 2.8 Install Tutorial Data See the Tutorial Data chapter for instructions on downloading and setting-up the tutorial data. References "],["workflow.html", "Chapter 3 Workflow 3.1 Units of Analysis 3.2 Analysis Levels 3.3 Geodatabases 3.4 Derived Features 3.5 Project Folder Structure 3.6 Workflows 3.7 Quality Assurance", " Chapter 3 Workflow This chapter provides an overview of some of the workflows that can be used to perform a rapid watershed assessment using FluvialGeomorph. Through analyzing a wide range of project sites, we have created a standard analysis framework. This framework defines a series of standard analysis objects that are used in a regular process to perform different types of analysis. 3.1 Units of Analysis To help organize the workflow process we have defined several units of analysis: Project: These are the primary work units and correspond to projects that customers have requested for analysis. Customers define specific goals for each project that determine the specific workflow chosen. These goals define a project study area for each project. These project study areas typically consist of a particular watershed, a mainstem section of a named river, or a discrete stream reach. Site: Project areas are subdivided into sites. Sites are typically named tributaries and their subwatersheds within the project study area. Reach: Sites are further subdivided into reaches. Reaches are defined according to project goals and use conventional rules for specifying reaches (i.e., tributary confluence to confluence), significant infrastructure, changes in surficial geology, etc. Year: Since FluvialGeomorph analysis is based on LiDAR terrain surveys, the timing of the survey is a critical factor in the analysis. LiDAR is a single point-in-time dataset. Since LiDAR can be collected periodically, our data structure must accommodate multiple distinct time periods for which channel dimensions are extracted. If there are multiple LiDAR surveys available for the project study area, the most recent survey is referred to as the base year. 3.2 Analysis Levels We have defined a standard workflow that is modular, allowing analysts to prescribe and customers to purchase progressively more detailed analysis as needed. The workflow is organized according to the following levels: Level 1: Extract basic channel dimensions and profile. Level 2: Extract bankfull channel dimensions and profile. Level 3: Extract planform dimensions. 3.3 Geodatabases The FluvialGeomorph workflow was designed around a standard set of objects organized into a standard set of geodatabases. Study Area Geodatabase: This type of geodatabase stores feature classes (FC) that apply to the entire project study area. The workflow begins with developing FCs that define the project study area, Digital Elevation Models (DEM), derived stream network, etc. If there are multiple LiDAR surveys for the project study area, a separate study area geodatabase representing each survey is created beginning with the base year. Site Geodatabase: This type of geodatabase stores FCs that apply to a specific site. Datasets developed for the entire study area are clipped to the specific site unit of analysis and stored in the site geodatabase. If there are multiple LiDAR surveys for the project study area, a separate site geodatabase representing each survey is created beginning with the base year. Reach Geodatabase: This type of geodatabase stores FCs that apply to a specific reach. The FluvialGeomorph tools create a standard set of FCs. Creating a separate geodatabase for each reach allows these standard FCs to be created for each reach unit of analysis. If there are multiple LiDAR surveys for the project study area, a separate reach geodatabase representing each survey is created beginning with the base year. 3.4 Derived Features The definition of a common set of derived features is an important step in standardizing any workflow. The standard FluvialGeomorph database objects form a tightly linked set of features that work together in a particular order to accomplish the analysis. See the FluvialGeomorph Tech Manual for a detailed description of each of these standard FCs. 3.5 Project Folder Structure Establishing a standard storage structure for all project data is an important quality control step. A standard folder structure has the following benefits: Clearly defined functional roles for each storage location reduces ambiguity and confusion. Predictability reduces errors. Standard structure allows analysts to move between projects more easily. The following folder structure is recommended to organize all project data: Project_Name  Sites   01_Site_Name    Data    Site1_year1.gdb    Site1_year2.gdb    Reach1_year1.gdb    Reach1_year2.gdb    Reach2_year1.gdb    Reach2_year2.gdb    ...    Elevation    year1.gdb    year2.gdb    ...    Exports    Maps    Reports   02_Site_Name  ...  Elevation   Year1   year1.gdb    LAS   Year2  year2.gdb   LAS  ...  Exports  Maps Project Study Area Folder: The project study area folder is used to store all of the files for the project. Site Folders: Site folders are used to store all of the files for each site. Each site in the project study area gets its own folder. Site folder order can be controlled by prefixing a number to each site name. Elevation Folders: The elevation folders are used to store all of the data required to create a DEM for each LiDAR survey event. A LAS subfolder at the project level is used to hold all of the point cloud data (typically delivered in .las format for modern surveys) for each LiDAR survey for the project study area. Since these datasets can be massive, the idea is to separate these data into their own folder to streamline data management. Once the terrain data are processed at the project study area level, only derived DEMs are then copied to the site and reach geodatabases in the site data folders. Site Data Folders: The site data folders are used to store all of the site site and reach geodatabases. Reports: The Reports folders are used to store the reports created by tools for each reach. Maps: The Maps folders are used to store map documents for a given project or site. Exports Folders: The Exports folders are used to store static .pdf map documents exported from map projects for a given project or site. 3.6 Workflows The FluvialGeomorph workflow has been organized using the following hierarchical grouping to help analysts better understand how to perform the analysis and what is being done during each step of the process. All workflow steps are sequential and build on the outputs of previous steps. Levels: The top hierarchical grouping of the workflow. Levels are distinguished by the degree of fluvial geometric detail and metrics that will be derived. Levels 2 and 3 are optional. Stages: The second hierarchical grouping of the workflow. Each level is subdivided into stages. Stages are mostly a conceptual grouping of steps to accomplish a specific objective in the analysis chain. Steps: The third hierarchical grouping of the workflow. Stages are subdivided into steps. Steps typically involve running tools, manual editing, and performing quality assurance checks. Tools: Tools are the lowest hierarchical grouping of the workflow. Tools perform operations that are suitable for automation. 3.6.1 Level 1 The purpose of this level is to extract basic channel dimensions. This section will provide a brief overview of the Level 1 (L1) workflow. Figure 3.1: Level 1 Workflow Diagram Create Terrain: The purpose of this stage is to develop the terrain models for the project study area for all available LiDAR surveys. Acquire Point Cloud - Identify the elevation data steward and download or transfer the LiDAR point cloud data on an external drive. Derive DEM - Assemble the .las files into a LAS Dataset, apply class filters, and export as a raster DEM. Hydromodify DEM - Identify flow blockages along streams and burn these features into the DEM. Define Stream Reaches: The purpose of this stage is to derive a synthetic stream network for the entire project study area and define their contributing watersheds. Calculate Contributing Area - Calculate the flow accumulation model for the DEM. Derive Stream Network - Use the flow accumulation model to derive the synthetic flow stream_network FC for the project study area. Define Reaches - Subdivide the project study area stream_network FC into a set of analysis reaches. Delineate Watersheds - Use the flow accumulation model to delineate the watersheds for all project study area reaches. Derive Flowline: The purpose of this stage is to derive a flowline, for each reach and survey event. Derive Flowline - Develop the flowline FC for each reach and survey event. Create Flowline Points - Create the flowline_points FC for each reach and survey event. Define Initial Floodplain and Channel Extent: The purpose of this stage is to define the initial floodplain and channel extent, for each reach and survey event. Detrend DEM - Use the flowline_points FC to develop a relative elevation model for each reach and survey event. Estimate Initial Channel Extent - Use the detrend DEM to interactively flood the channel to make an initial estimate of the detrended bankfull elevation. Estimate Initial Floodplain Extent - Use the detrend DEM to interactively flood the active floodplain to make an initial estimate of the detrended floodplain elevation. Calculate Channel Slope Raster - Calculate the slope raster of the initial channel extent area. Create Regular Cross Section Geometry: The purpose of this stage is to create regularly spaced cross sections and calculate dimensions, for each reach and survey event. Create Regular Cross Sections - Create regularly spaced cross sections along each reach. Calculate Cross Section Watershed Area - Calculate the watershed area for each regularly spaced cross section. Calculate Cross Section River Position - Calculate the river position for each regularly spaced cross section. Calculate Cross Section Points - Convert each cross section into a set of evenly stationed points and assign DEM and detrended elevation values. Calculate Cross Section L1 Dimensions - Calculate the L1 dimensions for the regularly spaced cross sections. Identify Features: The purpose of this stage is to identify salient features along each reach. Create Features - Identify the longitudinal position of noteworthy stream features for graph and map labeling. Run Report: The purpose of this stage is to run the Level 1 report for each reach. Run the Level 1 Report - Run the L1 report for each reach. Perform QA - Use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. 3.6.2 Level 2 The purpose of this level is to extract bankfull channel dimensions. This section will provide a brief overview of the Level 2 (L2) workflow. Create Initial Riffle Geometry: The purpose of this stage is to identify and map riffle cross sections and roughly estimate an initial bankfull elevation for the base year for each reach. Create Riffle Floodplain - Identify riffle locations and map these cross sections across the lateral extent of the floodplain for each reach. Calculate Cross Section Watershed Area - Calculate the watershed area for each riffle cross section. Calculate Cross Section River Position - Calculate the river position for each riffle cross section. Create Riffle Channel - Edit the lateral extent of the riffle_channel FC to just cover the initial channel extent. Calculate Cross Section Points - Convert each riffle cross section into a set of evenly stationed points and assign DEM and detrended elevation values. Calculate Initial Cross Section L2 Dimensions - Calculate the initial L2 dimensions for the the riffle cross sections for each reach. Estimate Bankfull: The purpose of this stage is to estimate the detrended bankfull elevation for the base year for each reach. Run the Estimate Bankfull Report - Run the Estimate Bankfull report for each reach. Perform QA - Use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. Determine Bankfull Elevation - Interpret the Estimate Bankfull Report to determine the final detrended bankfull elevation to be used for the rest of the analysis for each reach. Create Bankfull Area - Use the final bankfull elevation determined in the previous step to derive a final bankfull_area polygon for each reach. Create Banklines - Convert the bankfull_area polygon into polylines and edit into a banklines FC for each reach. Calculate Final L2 Cross Section Geometry: The purpose of this stage is to use the bankfull elevation determined in the last stage to calculate the final level 2 cross section dimensions for the base year for each reach. Calculate Final Cross Section L2 Dimensions - Calculate the final L2 dimensions for the regularly spaced and riffle cross section FCs for each reach. Run Report: The purpose of this stage is to produce the Level 2 report for each reach. Run the L2 Report - Run the L2 report for each reach. Perform QA - Use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. 3.6.3 Level 3 The purpose of this level is to extract planform dimensions. This section will provide a brief overview of the Level 3 (L3) workflow. Define Valley Line: The purpose of this stage is to define the valley trend line for the base year for each reach. Determine Final Floodplain Extent - Use the detrended bankfull elevation identified in L2 to delineate the active floodplain. Develop Candidate Valleylines - Create a set of candidate valleylines through iterative smoothing of the flowline for each reach. Choose Final Valleyline - Choose from the candidate valleylines the one that best captures the overall valley trend line. Define Meander Loops: The purpose of this stage is to define meander loops and bends for the base year for each reach. Define Loop Points - Create a new FC named loop_points and use it to identify the start and end stream meander loops and bends. Derive Bankline Points - Convert the banklines to a set of points and assign elevations and loop and bend locations. Assign Cross Section Loops - Assign loop and bend identifiers to regularly spaced and riffle cross section FCs for each reach. Calculate L3 Cross Section Geometry: The purpose of this stage is to calculate the Level 3 dimensions for each reach. Calculate Cross Section L3 Dimensions - Calculate the L3 dimensions for the regularly spaced and riffle cross section FCs for each reach. Run Report: The purpose of this stage is to run the Level 3 report for each reach. Run the L3 Report - Run the L2 report for each reach. Perform QA - Use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. 3.7 Quality Assurance This workflow contains a LOT of detailed steps! If everything isnt done just right, problems happen. So to help analysts stay on top of all of these details, we have adopted a layered approach to making sure everything gets done right. Here are the ways Task Tracking Spreadsheet: To guide analysts through this workflow, we have developed a task tracking spreadsheet to use to record progress through the analysis. This spreadsheet allows an analyst to record the completion of each of the steps outlined above, as well as key values used in the analysis. This spreadsheet can be stored in the site folder while data development progresses. Records in this spreadsheet can be periodically appended to a project or team level version to improve team communication on project progress. Check Tools: The FluvialGeomorph toolbox contains the Check toolset that allows the analyst to perform checks on the standard FluvialGeomorph FCs for basic rule compliance. If analysts have questions about if a specific FC is causing problems, these check tools can be used. Tool Error Messages: A series of low-level defensive programming checks have been implemented across all FluvialGeomorph functions and tools to help head-off problems. QA Checklist: The QA Checklist helps analysts review the reports created using the tools to identify and fix problems in the underlying derived data. See the QA Checklist chapter in this manual for details. "],["tutorial-data.html", "Chapter 4 Tutorial Data 4.1 Map Templates 4.2 Cole Creek", " Chapter 4 Tutorial Data This chapter describes how to download the tutorial data and configure your workspace. 4.1 Map Templates To standardize the maps used for this project, use these project site map templates. 4.2 Cole Creek In this section we will assemble the tutorial data for the Cole Creek Site in the Papillion Creek, NE project study area. Start preparing your project working directory by creating the following folder structure. See the project folder structure section for a detailed description of the functional role of each folder. Papillion_Creek  Sites   01_Cole_Creek    Data    Elevation    Exports    Maps    Reports  Elevation  Exports  Maps Download the Cole Creek Site Data site data using this link. Unarchive this .zip file to the Cole Creek site data folder. "],["level-1-workflow.html", "Chapter 5 Level 1 Workflow 5.1 Create Terrain 5.2 Define Stream Reaches 5.3 Derive Flowline 5.4 Define Initial Floodplain and Channel Extent 5.5 Create Regular Cross Section Geometry 5.6 Identify Infrastructure 5.7 Run Report 5.8 Determine Next Steps", " Chapter 5 Level 1 Workflow This chapter describes the workflow steps necessary to complete a Level 1 FluvialGeomorph analysis. 5.1 Create Terrain The purpose of this stage is to develop the terrain models for the project study area for all available LiDAR surveys. 5.1.1 Define Study Area The purpose of this step is to define the location and extent of the study area. 5.1.1.1 Create a Study Area Geodatabase The purpose of this step is to create a new study area geodatabase to store the project study area data. This step will need to be repeated for each LiDAR survey that exists for this project study area. Since three LiDAR surveys exist for the project study area, three geodatabases will need to be created: Papillion_Creek_2016.gdb Papillion_Creek_2010.gdb Papillion_Creek_2006.gdb The elevation data for each LiDAR survey will be processed separately and a synthetic stream network will be derived for each LiDAR survey independently. Begin processing the data for the base year first, then work backward in time to process earlier LiDAR surveys in reverse chronological order. Several analysis steps require the base year data to be processed first. For some tools, surveys prior to the base year use the base year data as inputs. This is done to express earlier surveys in terms of the base year for comparison purposes. Create a new folder on a local workstation drive. Name it for the project study area. Within this project folder, create a new study area file geodatabase. Name it for the study area. If there are multiple LiDAR surveys, add a date suffix to the geodatabase name. Choose a coordinate system for this project. You will use this coordinate system for all vector datasets created for this project. It is the analysts responsibility to ensure that each vector dataset in this project uses this coordinate system. The only exception to this requirement are raster DEMs (which may use another coordinate system). 5.1.1.2 Define the Longitudinal Extent of the Study Area Use the USGS National Hydrography Dataset(NHD) High Resolution to define the longitudinal extent of the reaches of the study area. Import the NHD Flowline feature class to represent the study area reaches. These will be used only as an initial coarse-scale representation of the study reaches to facilitate early study area definition. This study will derive high resolution definitions of study reaches. Edit the extent of the NHD Flowline feature class into a set of initial study area reaches. 5.1.1.3 Define the Areal Extent of the Study Area. Create a new polygon feature class named study_area. This polygon should outline the extent of the study reaches. If the study reaches are already known, sub divide the study_area polygon into these study reaches. This polygon should define the must-have extent for both communicating the study area, as well as helping to define the area to acquire elevation data. 5.1.1.4 Determine the Contributing Watershed to the Study Area Use the NRCS Watershed Boundary Dataset (WBD) to define the upstream contributing watershed of the study reach. Depending on the scale of the study reach, identify the relevant hierarchical levels to characterize the study area. Import these Hydrologic Unit Code (HUC) polygons into the study area geodatabase. 5.1.2 Acquire Study Area Watershed Elevation Model The purpose of this step is to acquire an existing, pre-made DEM of the entire study area watershed. This DEM will help determine the following parameters: Determine if an existing, pre-made DEM will serve for this analysis. Derive study area watershed extents. Calculate reach scale drainage area. The coverage of this DEM should cover the entire upstream contributing watershed of the study area. Multiple LiDAR Surveys Since the study area watershed boundaries are unlikely to have changed between LiDAR surveys, it is unnecessary to acquire the entire watershed elevation model for LiDAR survey dates before the base year. Only the watershed elevation model representing the base year needs to be acquired. 5.1.2.1 Identify a source of elevation data for your study area 5.1.2.2 Determine if the pre-made DEM has sufficient resolution 5.1.2.3 Verify that the DEM elevations are in feet 5.1.2.4 Create a hillshade to improve visualization 5.1.3 Develop High Resolution Elevation Model The purpose of this DEM is to derive a detailed stream terrain model that meets the resolution requirements of the study. 5.1.3.1 Download LiDAR point cloud data 5.1.3.2 Build a DEM from LiDAR point cloud data 5.1.3.3 Verify that the DEM elevations are in feet 5.1.3.4 Create a hillshade to improve visualization 5.1.4 Hydro Modify DEM The purpose of this step is to create a hydro-modified DEM to ensure proper water flow across the study area. 5.1.4.1 Identify Flow Blockages The purpose of this step is to develop a cutlines feature class representing flow blockages in the study area. Examine the stream channel through the study area and determine if there are any blockages to flow in the DEM. Focus only on flow blockages within the main channel of the study reaches. Flow blockages outside of the the channels of the study reaches do not need to be identified for FluvialGeomorph analysis. These blockages are typically built infrastructure such as road embankments where streams are conveyed through culverts or underground storm water structures. If there are flow blockages in the study area reach channels, create a new line feature class named cutlines to store terrain modifications that remove flow blockages. This feature class must be in the same coordinate system as the DEM being modified. In an edit session, identify human structures that block flow along the channel of the stream reach being studied. Draw a cutline beginning at the upstream side of the blockage to a point just downstream of the blockage. The start point and end point of the cutline must cover the area to be modified. The downstream end of this cutline must be located in good data, because the lowest DEM value found along this line will be used to re-assign DEM values to all DEM pixels covered by the cutline. 5.1.4.2 Burn cutlines into the terrains The purpose of this step is to remove flow blockages from the terrain. Use the 02 - Burn Cutlines tool to burn the cutlines features into the study area watershed DEM. This tool creates the dem_hydro raster. Rename this DEM watershed_dem_hydro. Use the 02 - Burn Cutlines tool to burn the cutlines features into the high resolution DEM. This tool creates the dem_hydro raster. 5.2 Define Stream Reaches The purpose of this stage is to synthetically derive from the terrain the study area reaches and their watersheds. 5.2.1 Calculate Contributing Area The purpose of this step is to calculate the contributing drainage area for each pixel in the DEM. Use the 03a - Contributing Area D8 tool to calculate the contributing area for the study area watershed. This tool creates the contributing_area raster. Rename this DEM watershed_contributing_area. Use the 03 - Contributing Area tool to calculate the contributing area for the high resolution DEM. If created, use the dem_hydro raster as input. The processes parameter of the 03 - Contributing Area tool can be safely set to approximately 2 less than the number of cores on the computer running the tool. 5.2.2 Derive Stream Network The purpose of this step is to derive a synthetic vector stream network from the DEM for the study area. Use the high resolution DEM to derive the stream network. Use the 04 - Stream Network tool to create a synthetic stream network from the hydro-modified DEM. The processes parameter can be safely set to approximately 2 less than the number of cores on the computer running the tool. The threshold parameter should be set to a value of 200,000 to 500,000 depending on the study area. If the resulting stream_network is too dense (requiring a large amount of editing to remove extraneous tributaries), try rerunning the tool and increasing the threshold value. Conversely, if the resulting stream_network is too sparse (not enough of the stream network was delineated), try rerunning the tool and decreasing the threshold value. Edit the resulting stream_network feature class to remove all tributary streams that do not constitute the network that will be analyzed in this study. Edit the stream_network feature class to ensure that stream segments are represented by a single line and that there are no gaps in the steam network. 5.2.3 Calculate Slope and Sinuosity The purpose of this step is to examine the stream network slope and sinuosity to help make decisions about how best to define study reaches. Use the 04a - Stream Network Points tool to convert the stream_network feature class into the stream_networks_points feature class. Determine the moving window size Slope and sinuosity are scale dependent metrics. This means that these metrics are affected by the size of the upstream moving window used in their calculation. To determine the appropriate size of this moving window for this study area, use the following steps: It is recommended that slope and sinuosity be calculated using a moving window size equal to two meander wavelengths. Estimate a rough initial bankfull width for the reach. Use the DEM to examine several representative locations throughout the study area. Estimate the length of two meander wavelengths by multiplying the rough bankfull width by 10 (e.g., 30ft bankfull width * 10 = 300ft, two meander wavelengths). Determine how many stream_network_points two meander wavelengths represent. For example, if stream_network_points are spaced 1m apart on average, then two meander wavelengths would be 91 points (i.e., 300ft / 3.28084ft per m). Calculate Slope and Sinuosity Use the 04b - Slope and Sinuosity tool to calculate the slope and sinuosity of the stream_network_points feature class. Set the gradient_distance parameter to the number of upstream stream_network_points that you calculated in a previous step. If the elevations in the channel seem noisy, check the use_smoothing parameter and set the loess_span parameter to a value between 0-1. Confirm the degree of smoothing Use a chart to verify the choice of the smoothing loess_span parameter. Right-click on the gradient_* FC in the map Table of Contents and select Create Chart, and select Line. In the Date or Number dropdown, choose the field POINT_M. In the Aggregation dropdown, choose None. In the Numeric field(s) checklist, check the boxes next to Z and Z_smooth. Click the Apply button to view the chart. Visually assess the degree of smoothing. The smoothing should be high enough to eliminate LiDAR elevation noise, but not so high as to eliminate meaningful channel elevation change. If the smoothing is not ideal, re-run the tool and adjust the loess_span parameter. 5.2.4 Define Reaches The purpose of this step is to segment the stream network into a set of sites and reaches that can be analyzed in more detail through the remainder of the study. The stream_network must be sub-divided into a set of sites and reaches that meet the following requirements: Criteria for Creating Sites: A project study area composed of several sub-watersheds will need to be divided into a set of sites. Sites within a project area are typically named tributaries that are the next hierarchical level beneath the project. Criteria for Creating Reaches: Major tributaries should be used to divide a site into reaches. How big of an increase in drainage area/discharge constitutes a major tributary depends on the size of the watershed and physiographic region. A specific reach should contain a range of similar drainage area values. Slope and sinuosity can be considered in the decision to subdivide a reach. Built infrastructure may be used to divide reaches (e.g., dams, major roads). Study objectives may drive the definition of reaches (e.g., economic benefits analysis, existing project reach definition). The distribution of the slope and sinuosity values along the stream network may help determine the natural breaks in the stream network. Using the criteria chosen from the list above, use the standard ESRI edit tools to subdivide the stream_network feature class into a set of features representing the reaches of your study. Manually edit the stream_network feature class to modify the geometry to create a set of features representing the study area sites and reaches. Set the ReachName field to the value to be used to uniquely define sites and reaches throughout the remainder of the study. Reach names are typically created using the site name and adding a suffix for the reach (e.g., R1, R2, etc.). Site names are typically defined by the primary tributary name. Be deliberate with the naming of sites and reaches as these names are used for all operations by each tool. 5.2.5 Delineate Watersheds The purpose of this step is to delineate the areal extent of watersheds for each reach in the study area. In the stream_network_points feature class, select points that represent the downstream location of each of the sites in the project study area. Export these point features to a new feature class named watershed_points in the study area geodatabase. Use the 04c - Watershed tool to create a watershed polygon for each feature in the watershed_points feature class. 5.3 Derive Flowline The purpose of this stage is to create a new site geodatabase, derive the site flowline, create new reach geodatabases for each reach, and copy the flowline to each reachs geodatabase. 5.3.1 Create the site geodatabase The purpose of this step is to create a new site geodatabase and populate it with initial data. In the study area folder, begin by creating a new site folder named for the site. In the new site folder, create a new Data folder. In the new site data folder, create a new site geodatabase for each LiDAR survey. In the example above, the Papillion Creek project study area will be subdivided into a specific site called Cole Creek. Since there are multiple LiDAR surveys for this study area (e.g., 2016, 2010, 2006), three site geodatabases will need to be created. Cole_Creek_2016.gdb Cole_Creek_2010.gdb Cole_Creek_2006.gdb Back in the study area geodatabase, select the features in the stream_network feature class representing the current site. Use the Data | Export Features function to export the selected site features to the new site geodatabase. Name the exported feature class stream_network. Examine the dem_hydro raster and determine the maximum width of the active floodplain along the entire site. Be conservative with this estimate. Given its later use, it is important to generously overestimate this value. Use this maximum floodplain width estimate to buffer the reach stream_network feature class and name it stream_network_buffer. Use the ESRI Clip Raster tool to clip the study area geodatabase dem_hydro to the extent of the reach using the stream_network_buffer feature class. Save the clipped raster to the reach geodatabase and name it dem_hydro_&lt;buffer distance&gt; (e.g., dem_hydro_1000 for a buffer distance of 1000 meters). Use the ESRI Clip Raster tool to clip the study area geodatabase contributing_area to the extent of the reach using the stream_network_buffer feature class. Save the clipped raster to the reach geodatabase and name it contributing_area_&lt;buffer distance&gt; (e.g., contributing_area_1000 for a buffer distance of 1000 meters). If you discover in later steps that the buffer distance was underestimated, you will need to repeat this step with a wider buffer. 5.3.2 Create the Flowline The purpose of this step is to derive the site flowline. The 05 - Flowline tool converts a stream_network feature into a flowline FC. This tool smooths the stream_network geometry and converts the flowline into a route. Use the 05 - Flowline tool to process the site stream_network FC to produce a new flowline FC. Set the output_workspace parameter to the site geodatabase. Use a smooth_tolerance parameter value from 5-20. The goal is to produce a smooth flowline, but not to remove too much resolution from the line. Ensure that the flowline remains in the channel and is not simplified into the floodplain. If this occurs, rerun reducing the degree of smoothing. Edit the flowline feature class to ensure that the flowline is digitized beginning with the downstream end and digitized upstream. In an edit session, select the flowline feature, choose to edit vertices, and ensure that the red endpoint is at the upstream end of the flowline. If not, use the Reverse Direction (aka flip) command to ensure the flowline is digitized in the upstream direction. It is critical that the flowline is digitized in the upstream direction. If this step is not performed, all subsequent tools will malfunction. 5.3.3 Create the Reach Geodatabase The purpose of this step is to create a set of new reach geodatabases for each reach in a site and populate these reach geodatabases with initial data. This step will need to be repeated for each reach AND survey in the project study area site. For example, if a site has five reaches (e.g., R1-R5) and three LiDAR surveys (e.g., 2016, 2010, 2006), then a total of 15 reach geodatabases must be created at this stage: Reach Geodatabases Required for a Site with 5 Reaches and 3 LiDAR Surveys. 2016 2010 2006 y2016_R1.gdb y2010_R1.gdb y2006_R1.gdb y2016_R2.gdb y2010_R2.gdb y2006_R2.gdb y2016_R3.gdb y2010_R3.gdb y2006_R3.gdb y2016_R4.gdb y2010_R4.gdb y2006_R4.gdb y2016_R5.gdb y2010_R5.gdb y2006_R5.gdb In the site data folder, create a new reach geodatabase named for the reach. Use the ReachName value for the name of this new reach file geodatabase. Reach names are typically created using the site name and adding a suffix for the reach (e.g., R1, R2, etc.). Back in the site geodatabase, select the feature in the flowline feature class representing the current study reach. Use the Data | Export Features function to export the selected reach feature to the new reach geodatabase. Name the exported feature class flowline. Ensure this new reach geodatabase version of flowline contains only one feature representing the current reach. Ensure that the ReachName field contains the correct name for the reach. As this reach name value is used throughout the toolbox, it is extremely important to ensure this value is used consistently across all FCs for this reach. Failure to be consistent with the ReachName value will lead to lots of errors that are difficult to troubleshoot. Get it right from the beginning. 5.3.4 Create Flowline Points The purpose of this step is convert the flowline into a series of points along the reach. The 06 - Flowline Points tool takes the flowline feature class, converts it to a route, calculates the distance to the mouth of the river for all vertices, and creates a flowline_points feature class. Use the 06 - Flowline Points tool to convert the flowline feature class into a new FC named flowline_points. Set the station_distance field to approximately 1 meter. For a site with multiple reaches, set the km_to_mouth parameter for the downstream-most reach to 0. Set the km_to_mouth parameter for each upstream reach to the upstream-most value (i.e., the highest km_to_mouth value of the downstream reachs flowline_points FC) of the downstream reach. For example, set the km_to_mouth of the Reach-2 flowline_points FC to 1.2345 if the maximum value of Reach-1s flowline_points FC km_to_mouth field is 1.2345. The goal is that longitudinal stationing within a site containing multiple reaches should be sequential and unique throughout the site (i.e., lower station values at the bottom of the site and higher station values at the top of the site). This allows reach FCs to be combined after reach-level analysis is complete. The calibration_points, point_id_field, and measure_field parameters can be left blank when processing the base year. Multiple Surveys To make LiDAR surveys collected before the base year directly comparable to the base year, previous survey flowlines must be calibrated to the base year. This adjusts any changes in flowline planform between surveys to be expressed in terms of the base year longitudinal stationing. If multiple LiDAR surveys exist for a project study area, the flowline_points for any previous LiDAR survey must be calibrated using the flowline_points of the base year. For example, if 2016 is the base year, when deriving the flowline_points for a LiDAR survey from 2010, the base years flowline_points (2016) must be used for the 06 - Flowline Points tools calibration_points parameter value. Set the point_id_field and measure_field parameters to the fields in the base years flowline_points FC. Set the search_radius parameter to the maximum distance between the flowline of the current survey and the base year flowline. 5.4 Define Initial Floodplain and Channel Extent The purpose of this stage is to define the initial floodplain and channel extent, for each reach and survey event. 5.4.1 Detrend DEM The purpose of this step is to produce a detrended DEM. A detrended DEM normalizes stream bank elevations for a specific reach. Inspect the reach to determine the width of the active floodplain. Use the measure tool to measure from the flowline outward to the widest extent of the active floodplain. This value will be used as the buffer_distance value in the following step. Use the 07 - Detrend tool to create a detrended DEM for the study reach. Set the buffer_distance field to a distance wide enough to capture the reachs entire active floodplain. 5.4.2 Estimate Initial Channel Extent The purpose of this step is to use the detrended DEM to visually extract an initial channel extent polygon. The detrend DEM created in the last step can be used to iteratively explore different inundation extents derived from various water surface elevations. Add the detrend feature class to the map Table of Contents. Name this layer Channel Extent. On the Symbology tab of the Channel Extent layer, use the Classified renderer to classify the raster into 2 classes. Set the first class boundary to the detrended elevation that you would like to explore. Set the color of the first class (min value - detrended elevation) to blue and the color of the second class (detrended elevation - max value) to No Color. Set the transparency of the Channel Extent layer to 50%. Begin to delineate the channel extent by selecting a detrended elevation that inundates the channel up to at least the first terrace. The goal at this stage is to select a detrended elevation that captures the extent of the channel without spilling too much water into the floodplain. Once you discover which detrended elevation begins to allow water to access the floodplain, reduce the detrended elevation value slightly to keep the water in the channel. Try several detrended elevation values to help make the decision. When you have chosen a detrended elevation, use the 08 - Water Surface Extent tool to extract an initial channel extent area polygon. This tool creates a new polygon feature class named banks_raw_xxx, where xxx is the detrended elevation selected. This feature class must be edited to select the channel area polygon(s). Open the attribute table for the banks_raw_xxx feature class and use advanced sorting to sort first by gridcode and then by Shape_Area. Polygons with gridcode = 1 are polygons inundated at the detrended elevation. Typically, the polygons with the largest area represent the channel. Begin selecting gridcode = 1 polygons with the largest area until the entire channel area is selected. Export these selected features to a new feature class named initial_channel_extent. Delete the banks_raw_xxx feature class created in this section. 5.4.3 Create the Initial Channel Mask layer The purpose of this step is to create a layer that defines an area just beyond the initial channel extent. Add the detrend feature class to the map Table of Contents. Name this layer Channel Mask. In the symbology of this layer, change the renderer from stretched to classified. Set the number of classes to 2. In the classification dialog, set the break value between the two classes to about one to two feet higher than the initial bankfull extent estimate. A couple of feet above the initial bankfull extent estimate should define the extent of the just the channel. For example, if the initial bankfull extent was estimated at 102 detrended feet, the initial bankfull height estimate would be 2 feet. One foot higher than the 2 foot initial bankfull height estimate would therefore be 103 detrended feet. Set the transparency of the Channel Mask layer to 50%. 5.4.4 Estimate Initial Floodplain Extent The purpose of this step is to create a layer that defines the an initial estimate of the floodplain inundation extent. Add the detrend feature class to the map Table of Contents. Name this layer Floodplain Mask. In the symbology of this layer, change the renderer from stretched to classified. Set the number of classes to 2. In the classification dialog, set the break value between the two classes to four times the initial bankfull extent estimate. Four times the initial bankfull extent estimate should define the extent of the active floodplain. For example, if the initial bankfull extent was estimated at 102 detrended feet, the initial bankfull height estimate would be 2 feet. Four times the 2 foot initial bankfull height estimate would therefore be 108 detrended feet. Set the transparency of the Floodplain Mask layer to 50%. 5.4.5 Calculate Channel Slope Raster The purpose of this step is to create a channel slope raster that can be used in the visual identification of riffle locations in following step. Use the 09 - Channel Slope tool to calculate a raster of the channel slope. Use the intitial_channel_extent polygon created earlier to define the channel area within which the slope raster will be calculated. This tool creates a new feature class named channel_slope. 5.5 Create Regular Cross Section Geometry The purpose of this stage is to create regularly spaced stream cross sections and extract terrain-derived hydraulic parameters for each reach and survey event. 5.5.1 Create Regular Cross Sections The purpose of this step is to create regularly spaced cross sections along each reach. The goal of this step is to create a set of regularly spaced cross sections that well represent the channel conditions found in this reach. Determine the typical maximum distance from the reach flowline to the edge of the active floodplain. The goal is not to identify the maximum distance to the edge of the floodplain, but to identify the typical distance to the edge of the floodplain. Determine the spacing between cross sections necessary to represent conditions along this stream. Cross section spacing for small stream of 50-100 feet works well. Larger rivers do not require such tight spacing. Use the 11 - XS Layout tool to create a set of regularly spaced cross sections (referred to as transects in this tool). Use the values determined in the previous steps to set this tools parameters. For a site with multiple reaches, regular cross sections must be uniquely numbered across all reaches. The Seq field values of regular cross sections should not repeat within the reaches of a site. The downstream-most cross section in the site should be numbered starting with the Seq field value of 1 and increase moving upstream. The 11 - XS - Layout tool automatically numbers regular cross sections Seq values starting with the value 1 at the downstream-most cross section. For all reaches other than the first reach (downstream-most) in a site, the cross sections must be resequenced using the 13a - XS Resequence tool. Use the 13a - XS Resequence tool to set the starting Seq value for each reach. * Set the Seq field value for each upstream reach to the upstream-most value (i.e., the highest Seq value of the downstream reachs regular cross section FC) of the downstream reach. For example, set the Seq of the Reach-2 regular cross section FC to 58 if the maximum value of Reach-1s regular cross section FC Seq field is 57. 5.5.2 Calculate Cross Section Watershed Area The purpose of this step is to calculate the watershed area for each regularly spaced cross section. From the study area geodatabase, use the watershed_contributing_area raster that covers the entire contributing watershed of the study area. Use the ERSI Clip Raster tool to clip the watershed_contributing_area raster to stream_network_buffer to speed tool run time. Add the contributing_area_buffer raster to a map and symbolize with a hot-cold stretch renderer. Add the flowline and regular cross section features classes to the map. Place them on top of the contributing_area_buffer raster. Determine the maximum distance from the intersection of each cross section and the flowline to the nearest pixel of high flow in the contributing_area_buffer raster. This value will be used for the snap_distance in the next step. Use the 12 - XS Watershed Area tool to calculate the watershed area for each cross section. For the flow_accum parameter, use the contributing_area_buffer raster. For the snap_distance parameter, use the distance you calculated in a previous step. 5.5.3 Calculate Cross Section River Position The purpose of this step is to calculate the river position for each regularly spaced cross section. Use the 13 - XS River Position tool to calculate the distance to the mouth of the river for each cross section. The river position of each cross section will be used in later steps to calculate several channel parameters (i.e., gradient, sinuosity). 5.5.4 Calculate Cross Section Points The purpose of this step is to convert each cross section into a set of evenly stationed points and assign DEM and detrended elevation values. Use the 14 - XS Points tool to calculate cross section station points for each cross section. The station_distance parameter should be set to approximately the resolution of the DEM. For example, if the DEM has a cell size of 1 foot (0.3048 meter), set the station_distance to that distance (using the linear units of the coordinate system used for the projects vector data). This tool creates a new feature class named &lt;cross section FC name&gt;_points. 5.5.5 Calculate Cross Section L1 Dimensions The purpose of this step is to calculate the L1 dimensions for the regularly spaced cross sections. Determine the moving window size Many stream metrics are scale dependent, meaning these metrics are affected by the size of the moving window used in their calculation. To determine the appropriate size of the moving window for this reach, use the following steps: Many stream metrics are typically calculated using a moving window size equal to two meander wavelengths (one upstream meander wavelength and one downstream meander wavelength). Using the initial Channel Mask layer that you created earlier, estimate the typical bankfull width for the reach. Estimate the length of two meander wavelengths by multiplying the bankfull width estimated in the last step by 10 (e.g., 30ft bankfull width * 10 = 300ft, two meander wavelengths). Determine how many cross sections two meander wavelengths represent. For example, if regular cross sections are spaced 100ft apart, then two meander wavelengths would be 3 cross sections (i.e., 300ft / 100ft between cross sections). Calculate L1 Dimensions Use the 15a - XS Dimensions, Level 1 tool to calculate L1 dimensions. Set the xs_fc parameter to the regular cross sections FC you created in a previous step. Set the lead_n parameter to the number of upstream cross sections that you calculated in a previous step. If the elevations in the channel seem noisy, check the use_smoothing parameter and set the loess_span parameter to a value between 0-1. Confirm that the vert_units of the DEM are in feet. Confirm the degree of smoothing Use a chart to verify the choice of the smoothing loess_span parameter. Right-click on the *gradient_**_dims_L1 FC in the map Table of Contents and select Create Chart, and select Line. In the Date or Number dropdown, choose the field POINT_M. In the Aggregation dropdown, choose None. In the Numeric field(s) checklist, check the boxes next to Z and Z_smooth. Click the Apply button to view the chart. Visually assess the degree of smoothing. The smoothing should be high enough to eliminate LiDAR elevation noise, but not so high as to eliminate meaningful channel elevation change. If the smoothing is not ideal, re-run the tool and adjust the loess_span parameter. 5.6 Identify Infrastructure The purpose of this stage is to identify salient features in the floodplain that may be affecting channel hydraulics along each reach. Here are some ideas for the features you should identify: Significant tributaries Built infrastructure Significant geologic features 5.6.1 Create Features The purpose of this step is to identify the longitudinal position of noteworthy stream features for graph and map labeling. Create a new point FC named features containing the following fields: Name - Text (50), Used to record the name of the river feature. km_to_mouth - double, Used to record the features longitudinal position within the reach. Working upstream from the downstream end of the reach, examine the DEM and aerial imagery for significant river features and built infrastructure that could potentially impact stream structure and function. Add the flowline_points feature class to the current map. Set the display field to the km_to_mouth field. Create a features point feature centered along the flowline FC. Assign it a descriptive label in the Name field, and record its longitudinal position along the reach (see next bullet) in the km_to_mouth field. To determine a features longitudinal position along the reach, use the identify tool to find the closest point in the flowline_points feature class and use the value from its POINT_M value. Repeat these steps to record all of the significant features along each reach. 5.7 Run Report The purpose of this stage is to run the Level 1 report for each reach. 5.7.1 Run the Level 1 Report The purpose of this step is to run the L1 report for each reach. The Level 1 Report displays the channel dimensions for the base year, compared with multiple previous year surveys. In the Reports toolset, use the Level 1 Report tool to produce the Level 1 Report. For the stream parameter, use the value of the ReachName field used in the flowline FC. For the flowline_fc parameter, enter the flowline FC for the base year survey. For the xs_dimensions_fc parameter, use the *_dims_L1 FC calculated for the regular cross sections of the base year. The flowline_points_* parameters should be entered with the FC for the most recent survey first (i.e., the base year) and then the previous surveys in reverse chronological order (e.g., 2016, 2010, 2006). The xs_points_* parameters should be entered with the FC for the most recent survey first (i.e., the base year) and then the previous surveys in reverse chronological order (e.g., 2016, 2010, 2006). The survey_name_* parameters are used to label the surveys in maps and graphs. The FCs and labels used for the flowline_points_*, xs_points_*, and survey_name_* parameters must be entered in the same order (e.g., 2016, 2010, 2006) in each set of numbered parameters. For the features_fc parameter, enter the features FC for the base year survey. For the dem parameter, enter the DEM for the base year survey. 5.7.2 Perform QA The purpose of this step is to use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. Follow the instructions in the QA Checklist Chapter, Level 1 Report, to verify that the reports have run correctly. Make the required changes suggested in the QA Checklist and rerun the report. Repeat these QA iterations until the reports are correct. 5.8 Determine Next Steps The purpose of this step is to determine what further steps need to be taken. Review the results of the Level 1 Report and determine if the project goals require proceeding to developing the Level 2 analysis. "],["level-2-workflow.html", "Chapter 6 Level 2 Workflow 6.1 Create Initial Riffle Geometry 6.2 Estimate Bankfull 6.3 Calculate Final L2 Cross Section Geometry 6.4 Run Report 6.5 Determine Next Steps", " Chapter 6 Level 2 Workflow This chapter describes the workflow steps necessary to complete a Level 2 FluvialGeomorph analysis. 6.1 Create Initial Riffle Geometry The purpose of this stage is to identify and map riffle cross sections and roughly estimate an initial bankfull elevation for the base year for each reach. 6.1.1 Create Riffle Floodplain The purpose of this step is to identify riffle locations and map these cross sections across the lateral extent of the floodplain for each reach. A riffle is a shallow river landform where water flows in a steep, thin sheet (Luna Bergere Leopold and M. Gordon Wolman 1957). Riffles can be identified with the help of the channel_slope raster calculated in Level 1, and confirmed with high resolution aerial imagery. In the channel_slope raster, pools appear as relatively smooth areas of low slope due to the absence of LiDAR points (deep water absorbs laser pulses). Shallow water riffles appear as highly textured areas of relatively higher slope between pools due to the higher number of LiDAR points from the exposed bed material. Create a new line feature class (FC) named riffle_floodplain to store riffle cross sections. This feature class must use the same coordinate system as the vector datasets of the project. Add the following fields: ReachName: Text (50) - The purpose of this field is to store the reach name. Seq: long integer - The purpose of this field is to uniquely identify each cross section. Riffle Identifying Characteristics: A straight reach between two meander bends, areas in the cross-overs between river bends Clear indicators of the active floodplain or bankfull discharge Presence of one or more terraces Channel section and form typical of the stream A reasonably clear view of of geomorphic features Areas of high water surface slope (in the case of high gradient streams) Areas of minimum depth and width Channel width parallel and consistent Avoid tributary influences Cross sections should be drawn wide enough to capture the top of bank Digitize Riffles Digitize riffle cross sections beginning with the left descending bank. While editing, use the Reverse Direction command (aka flip) to ensure riffles are digitized in the correct direction. A red vertex denotes the end of a line segment. Therefore, the red end vertex should be on the right descending bank. Check that each cross section is digitized in the correct direction (start at the left descending bank and end on the right descending bank) before going on to the next step. Ensure that riffle cross sections are digitized to the full width of the active floodplain. Edit each riffle_floodplain feature to ensure that it extends at least to the edge of the Floodplain Mask layer, but no further. This ensures that each riffle_floodplain feature covers the entire floodplain, but does not extend too far into the uplands. For a site with multiple reaches, riffle cross sections must be uniquely numbered across all reaches. The Seq field values of riffle cross sections should not repeat within the reaches of a site. The downstream-most cross section in the site should be numbered starting with the Seq field value of 1 and increase moving upstream. If necessary, use the 13a - XS Resequence tool to set the starting Seq value for each reach. Set the Seq field value for each upstream reach to the upstream-most value (i.e., the highest Seq value of the downstream reachs riffle cross section FC) of the downstream reach. For example, set the Seq of the Reach-2 riffle cross section FC to 18 if the maximum value of Reach-1s riffle cross section FC Seq field is 17. 6.1.2 Assign Cross Section IDs The purpose of this step is to ensure that riffle cross section identifiers are properly assigned. Assignment of cross section unique identifiers is critical for later tools to uniquely identify each cross section. Assign integer values to the Seq field starting with one. Begin numbering at the downstream extent of the study area and moving upstream. 6.1.3 Calculate Cross Section Watershed Area The purpose of this step is to calculate the watershed area for each riffle cross section. From the study area geodatabase, use the watershed_contributing_area raster that covers the entire contributing watershed of the study area. Use the ERSI Clip Raster tool to clip the watershed_contributing_area raster to stream_network_buffer to speed tool run time. Add the contributing_area_buffer raster to a map and symbolize with a hot-cold stretch renderer. Add the flowline and regular cross section features classes to the map. Place them on top of the contributing_area_buffer raster. Determine the maximum distance from the intersection of each cross section and the flowline to the nearest pixel of high flow in the contributing_area_buffer raster. This value will be used for the snap_distance in the next step. Use the 12 - XS Watershed Area tool to calculate the watershed area for each cross section. For the flow_accum parameter, use the contributing_area_buffer raster. For the snap_distance parameter, use the distance you calculated in a previous step. 6.1.4 Calculate Cross Section River Position The purpose of this step is to calculate the river position for each riffle cross section. Use the 13 - XS River Position tool to calculate the distance to the mouth of the river for each cross section. The river position of each cross section will be used in later steps to calculate several channel parameters (i.e., gradient, sinuosity). 6.1.5 Create Riffle Channel The purpose of this step is to edit the lateral extent of the riffle_channel FC to just cover the initial channel extent. This allows a more detailed examination of the channel area. In the Catalog window, make a copy of the riffle_floodplain feature class and name it riffle_channel. Edit each riffle_channel feature to ensure that it extends at least to the edge of the Channel Mask layer, but no further. This ensures that each riffle_channel feature covers the entire channel, but does not extend too far into the floodplain. Use snapping to ensure that vertices of the riffle_channel features are coincident with the overlapping riffle_floodplain features. 6.1.6 Calculate Cross Section Points The purpose of this step is to convert each riffle cross section into a set of evenly stationed points and assign DEM and detrended elevation values. Use the 14 - XS Points tool to calculate cross section station points for each cross section. The station_distance parameter should be set to approximately the resolution of the DEM. For example, if the DEM has a cell size of 1 foot (0.3048 meter), set the station_distance to that distance (using the linear units of the coordinate system used for the projects vector data). This tool creates a new feature class named &lt;cross section FC name&gt;_points. Repeat this step for both the riffle_floodplain and riffle_channel FCs. 6.1.7 Calculate Initial Cross Section L2 Dimension The purpose of this step is to calculate the initial L2 dimensions for the the riffle cross sections for each reach. Repeat the following steps for both the riffle_floodplain FC and the riffle_channel FC. Determine the moving window size Many stream metrics are scale dependent, meaning these metrics are affected by the size of the moving window used in their calculation. To determine the appropriate size of the moving window for this reach, use the following steps: Many stream metrics are typically calculated using a moving window size equal to two meander wavelengths. Using the initial Channel Mask layer that you created earlier, estimate the typical bankfull width for the reach. Estimate the length of two meander wavelengths by multiplying the bankfull width estimated in the last step by 10 (e.g., 30ft bankfull width * 10 = 300ft, two meander wavelengths). Determine how many cross sections two meander wavelengths represent. For example, if riffle cross sections are spaced about 300ft apart, then two meander wavelengths would be 1 riffle cross section (i.e., 300ft / 300ft between riffle cross sections). Calculate Initial L2 Dimensions Use the 15b - XS Dimensions, Level 2 tool to calculate L2 dimensions. Set the xs_fc parameter to the regular cross sections FC you created in a previous step. Set the lead_n parameter to the number of upstream cross sections that you calculated in a previous step. If the elevations in the channel seem noisy, check the use_smoothing parameter and set the loess_span parameter to a value between 0-1. Confirm that the vert_units of the DEM are in feet. Confirm the degree of smoothing Use a chart to verify the choice of the smoothing loess_span parameter in the *_dims_L2 FC. Right-click on the *_dims_L2 FC in the map table of contents and select Create Chart, and select Line. In the Date or Number dropdown, choose the field POINT_M. In the Aggregation dropdown, choose None. In the Numeric field(s) checklist, check the boxes next to Z and Z_smooth. Click the Apply button to view the chart. Visually assess the degree of smoothing. The smoothing should be high enough to eliminate LiDAR elevation noise, but not so high as to eliminate meaningful channel elevation change. If the smoothing is not ideal, re-run the tool and adjust the loess_span parameter. 6.2 Estimate Bankfull The purpose of this stage is to estimate the detrended bankfull elevation for the base year for each reach. This report conducts a sensitivity analysis using the regional curve estimates of channel dimensions across a range of elevation values to identify the detrended bankfull elevation value that best fits the regional curve estimate. 6.2.1 Run the Estimate Bankfull Report The purpose of this step is to run the Estimate Bankfull report for each reach. In the Reports toolset, use the Estimate Bankfull tool to produce the Estimate Bankfull Report. For the stream parameter, use the value of the ReachName field used in the flowline FC. For the flowline_fc parameter, enter the flowline FC for the base year survey. For the xs_dims_fc parameter, use the riffle_channel_dims_L2 FC calculated for the base year. The xs_points_ch_* parameter set requires a riffle_channel_points FC. These FCs should be entered with the FC for the most recent survey first (i.e., the base year) and then the previous surveys in reverse chronological order (e.g., 2016, 2010, 2006). The xs_points_fp_* parameter set requires a riffle_floodplain_points FC. These FCs should be entered with the FC for the most recent survey first (i.e., the base year) and then the previous surveys in reverse chronological order (e.g., 2016, 2010, 2006). The survey_name_* parameters are used to label the surveys in maps and graphs. The FCs and labels used for the xs_points_* and survey_name_* parameters must be entered in the same order (e.g., 2016, 2010, 2006) in each set of numbered parameters. For the features_fc parameter, enter the features FC for the base year survey. For the dem parameter, enter the DEM for the base year survey. For the regions parameter, select the regions to use for estimating the bankfull water surface elevation. For the from_elevation parameter, specify the lowest detrended elevation value to use for sensitivity analysis. For the to_elevation parameter, specify the highest detrended elevation value to use for sensitivity analysis. For the by_elevation parameter, specify the value to increment the sequence between from_elevation and to_elevation. The three values (i.e., from_elevation, to_elevation, and by_elevation) define the sequence used for the sensitivity analysis. For the bf_estimate parameter, specify the detrended elevation value that represents the bankfull water surface elevation. 6.2.2 Perform QA The purpose of this step is to use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. Follow the instructions in the QA Checklist Chapter, Estimate Bankfull Report section, to verify that the reports have run correctly. Make the required changes suggested in the QA Checklist and rerun the report. Repeat these QA iterations until the reports are correct. 6.2.3 Determine Bankfull Elevation The purpose of this step is to interpret the Estimate Bankfull Report to determine the final detrended bankfull elevation to be used for the rest of the analysis for each reach. The Estimate Bankfull tool is intended to be run iteratively, testing the fit of a range of detrended bankfull elevations against different regional curves. From the initial Estimate Bankfull Report, use the Bankfull Elevation Goodness of Fit sensitivity analysis graph to examine the effect of choice of detrended bankfull elevation on the error statistic. Identify the detrended bankfull elevation that minimizes error on the Bankfull Elevation Goodness of Fit sensitivity analysis graph. In the example figure below, the detrended bankfull elevation of 104 ft. minimizes error (y-axis Mean Average Error) for both area and depth. Although 102 ft. appears to be the detrended elevation that minimizes error for width, 104 ft. does a better job for area and depth. Using the logic of best two out three, a detrended bankfull elevation of 104 ft. could be chosen for this reach and will be used for later steps in this analysis. However, other criteria could be used depending on the goals of your study. Rerun the report using the value chosen in the previous step. Figure 6.1: Bankfull Elevation Goodness of Fit 6.2.4 Create Bankfull Area The purpose of this step is to use the final bankfull elevation determined in the previous step to derive a final bankfull_area polygon for each reach. From the final Estimate Bankfull Report, use the detrended bankfull elevation identified in the last step. In the example above, this value was 104 ft. Use the 08 - Water Surface Extent tool to extract a bankfull area polygon. This tool creates a new polygon feature class named banks_raw_xxx, where xxx is the detrended elevation specified. The banks_raw_xxx FC must be edited to select only the polygons that represent the bankfull area polygon(s). Open the attribute table for the banks_raw_xxx FC and use advanced sorting to sort first by gridcode and then by Shape_Area. Polygons with gridcode = 1 are polygons inundated at the detrended elevation. Typically, the polygons with the largest area represent the channel. Begin by selecting gridcode = 1 polygons with the largest area until the entire bankfull area is selected. Export these selected features to a new feature class named bankfull_area. Delete the banks_raw_xxx FC. 6.2.5 Create Banklines The purpose of this step is to convert the bankfull_area polygon into polylines and edit into a banklines FC for each reach. The banklines feature class will have two records, one representing the left descending bankline and another the right descending bankline for the stream reach. Use the ESRI Polygon To Line tool to convert the bankfull_area polygon FC to a new polyline FC named banklines. Add the following fields to the banklines FC: ReachName: Text (50) - The purpose of this field is to store the reach name. bank_id: Long Integer - The purpose of this field is to uniquely identify each bank. bank: Text (50) - The purpose of this field is to designate which bank is the right descending bank and which is the left descending bank. Start editing the banklines FC. Use the ESRI Explode Multipart Feature tool to explode any multipart line feature in the banklines FC. Add the flowline FC to the map. Use the ESRI Split Tool to split the line features at the downstream and upstream ends of the flowline FC. The features in the banklines FC should not extend past the end of the flowline feature. Use the ESRI Split Tool to trim any tributaries from the banklines FC. The goal of this step is to have only two features, one representing the left descending bankline and another the right descending bankline. Delete all other line features. Ensure that the banklines are digitized in the upstream direction (like a flowline feature). Edit the banklines FC to ensure that each bankline is digitized beginning with the downstream end and digitized upstream. While editing, select a bankline feature, choose to edit vertices. Ensure that the red endpoint is at the upstream end of each bankline. Use the Reverse Direction command (aka flip) to ensure each bankline is digitized in the upstream direction. Check that each bankline is digitized in the upstream direction (red endpoint at the upstream end) before going on to the next step. In the ReachName field enter the reach name. In the bank field, enter the string right descending or left descending to designate which bank each line represents. In the bank_id field enter a 1 for the right descending bank and 2 for the left descending bank. 6.3 Calculate Final L2 Cross Section Geometry The purpose of this stage is to use the bankfull elevation determined in the last stage to calculate the final level 2 cross section dimensions for the base year for each reach. 6.3.1 Calculate Final Cross Section L2 Dimensions The purpose of this step is to calculate the final L2 dimensions for the regularly spaced and riffle cross section FCs for each reach. Repeat the following steps for regular spaced cross section FC, the riffle_floodplain FC, and the riffle_channel FC. Determine the moving window size Many stream metrics are scale dependent, meaning these metrics are affected by the size of the moving window used in their calculation. To determine the appropriate size of the moving window for this reach, use the following steps: Many stream metrics are typically calculated using a moving window size equal to two meander wavelengths. Using the bankfull_area FC, estimate the typical bankfull width for the reach. Estimate the length of two meander wavelengths by multiplying the bankfull width estimated in the last step by 10 (e.g., 30ft bankfull width * 10 = 300ft, two meander wavelengths). Determine how many cross sections two meander wavelengths represent. For riffle cross section for example, if they are spaced about 300ft apart, then two meander wavelengths would be 1 riffle cross section (i.e., 300ft / 300ft between riffle cross sections). For regular cross section for example, if they are spaced about 100ft apart, then two meander wavelengths would be 3 regular cross sections (i.e., 300ft / 100ft between regular cross sections). Calculate Final L2 Dimensions Delete the initial Level 2 dimensions *_dims_L2 FCs created earlier in Level 2. Use the 15b - XS Dimensions, Level 2 tool to calculate final L2 dimensions. Set the xs_fc parameter to the cross sections FC. Set the lead_n parameter to the number of upstream cross sections that you calculated in a previous step depending on the type of cross section (i.e., regular cross section, riffle cross section). If the elevations in the channel seem noisy, check the use_smoothing parameter and set the loess_span parameter to a value between 0-1. Confirm that the vert_units of the DEM are in feet. Confirm the degree of smoothing Use a chart to verify the choice of the smoothing loess_span parameter in the *_dims_L2 FC. Right-click on the *_dims_L2 FC in the map table of contents and select Create Chart, and select Line. In the Date or Number dropdown, choose the field POINT_M. In the Aggregation dropdown, choose None. In the Numeric field(s) checklist, check the boxes next to Z and Z_smooth. Click the Apply button to view the chart. Visually assess the degree of smoothing. The smoothing should be high enough to eliminate LiDAR elevation noise, but not so high as to eliminate meaningful channel elevation change. If the smoothing is not ideal, re-run the tool and adjust the loess_span parameter. 6.4 Run Report The purpose of this stage is to produce the Level 2 report for each reach. 6.4.1 Run the L2 Report The purpose of this step is to run the L2 report for each reach. In the Reports toolset, use the Level 2 Report tool to produce the Level 2 Report. For the stream parameter, use the value of the ReachName field used in the flowline FC. For the flowline_fc parameter, enter the flowline FC for the base year survey. For the xs_dims_fc parameter, use the *_dims_L2 FC calculated for the regular cross sections of the base year. The xs_points_* parameters should be entered with the FC for the most recent survey first (i.e., the base year) and then the previous surveys in reverse chronological order (e.g., 2016, 2010, 2006). The survey_name_* parameters are used to label the surveys in maps and graphs. The FCs and labels used for the flowline_points_*, xs_points_*, and survey_name_* parameters must be entered in the same order (e.g., 2016, 2010, 2006) in each set of numbered parameters. For the dem parameter, enter the DEM for the base year survey. For the banklines_fc parameter, enter the banklines FC created for the base year survey. For the features_fc parameter, enter the features FC for the base year survey. For the bf_estimate parameter, specify the detrended elevation value that represents the bankfull water surface elevation. For the regions parameter, select the regions to use for estimating the bankfull water surface elevation. 6.4.2 Perform QA The purpose of this step is to use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. Follow the instructions in the QA Checklist Chapter, Level 2 Report section, to verify that the reports have run correctly. Make the required changes suggested in the QA Checklist and rerun the report. Repeat these QA iterations until the reports are correct. 6.5 Determine Next Steps The purpose of this step is to determine what further steps need to be taken. Review the results of the Level 2 Report and determine if the project goals require proceeding to developing the Level 3 analysis. References "],["level-3-workflow.html", "Chapter 7 Level 3 Workflow 7.1 Define Valley Line 7.2 Define Meander Loops 7.3 Calculate L3 Cross Section Geometry 7.4 Run Report 7.5 Determine Next Steps", " Chapter 7 Level 3 Workflow This chapter describes the workflow steps necessary to complete a Level 3 FluvialGeomorph analysis. The purpose of this level is to extract planform dimensions. This section will provide a brief overview of the Level 3 (L3) workflow. 7.1 Define Valley Line The purpose of this stage is to define the valley trend line for the base year for each reach. 7.1.1 Determine Final Floodplain Extent The purpose of this step is to use the detrended bankfull elevation identified in L2 to delineate the active floodplain. From the final Estimate Bankfull Report created in Level 2, use the detrended bankfull elevation identified. In the example from Level 2, this value was 104 ft. Determine the bankfull depth: The detrending process used in FluvialGeomorph expresses stream elevations using a base index value of 100 ft. Therefore a detrended bankfull elevation estimated to be 104 ft. means that at bankfull discharge, the water surface elevation is 4 ft. above the detrended stream base index value of 100 ft. for this reach: 104 ft detrended bankfull elevation - 100 ft detrended stream base index = 4 ft bankfull depth Determine flood prone height: Flood prone has been determined through empirical studies to be approximately two times the bankfull depth. For example, using the bankfull depth calculated in the last step, calculate the flood prone depth using the following formula: 2 * 4 ft bankfull depth = 8 ft flood prone height Therefore, the flood prone detrended elevation would be 108 ft: 100 ft detrended stream base index + 8 ft flood prone height = 108 ft detrended flood prone height With the detrended flood prone elevation for your reach determined in the last step, use the 08 - Water Surface Extent tool to extract a flood prone area polygon. This tool creates a new polygon feature class named banks_raw_xxx, where xxx is the detrended elevation selected. This feature class must be edited to select the flood prone area polygon(s). Open the attribute table for the banks_raw_xxx feature class and use advanced sorting to sort first by gridcode and then by Shape_Area. Polygons with gridcode = 1 are polygons inundated at the detrended elevation. Typically, the polygons with the largest area represent the channel. Begin selecting gridcode = 1 polygons with the largest area until the entire flood prone area is selected. Export these selected features to a new feature class named flood_prone. Delete the banks_raw_xxx feature class created in this section. 7.1.2 Develop Candidate Valleylines The purpose of this step is to create a set of candidate valleylines through iterative smoothing of the flowline for each reach. The following steps are performed in the site geodatabase for the base year. This is done to ensure that a valleyline is created smoothly through all of the reaches in a site. In the site geodatabase for the base year, use the ESRI Smooth Line tool to smooth the site flowline FC. Choose the PAEK smoothing algorithm. For the first candidate valleyline, use a Smoothing Tolarance value of 200 meters. In this case you would name the output feature class valleyline_200 Repeat the previous step using the Smoothing Tolerance values such as 400, 800, and 1000. Depending on the detail of the flowline geometry, you may need to select a different range or set of step values of the Smoothing Tolerance parameter values to evaluate. The goal is to create a wide degree of flowline smoothing in the candidate vallelines to select from in the next step. 7.1.3 Choose Final Valleyline The purpose of this step is to choose from the candidate valleylines the one that best captures the overall valley trend line. The goal of this step is to select from the candidate valleylines the one that is the most smoothed, yet still fits primarily within the flood_prone polygon extent. Add the flood_prone polygon and all of the candidate valleyline FCs to the current map. Identify the valley line feature class that has the highest smoothing tolerance value that also is mostly contained within the extent of the flood_prone polygon. In the site geodatabase of the base year, rename the selected valley line to valleyline. Delete the unused candidate valleylines from the site geodatabase of the base year. Copy the valleyline FC you just created from the site geodatabase to each of the base year reach geodatabases. 7.2 Define Meander Loops The purpose of this stage is to define meander loops and bends for the base year for each reach. 7.2.1 Define Loop Points The purpose of this step is to create a new FC named loop_points and use it to identify the start and end stream meander loops and bends. Create a new point feature class named loop_points. Enable z and m values. The feature class should contain the following fields: ReachName: Text (50) - The purpose of this field is to store the reach name. loop: Long Integer - The purpose of this field is to store the loop unique identifier for the point. bend: Long Integer - The purpose of the field is to store the bend identifier for the point. position: Text (10) - The purpose of this field is to store position identifier for the point. This field must have one three values: start, end, or apex. Create Loop Points loop_point features are used to define the start and end location of loop bends and the location of a loops apex. loop_point features are always placed along (i.e., snapped to) a bankline feature. Begin numbering loops starting at the downstream end of the reach and increment the loop integer values moving upstream. In FluvialGeomorph, the valleyline is used segment the flowline into loops. The beginning and end of loops are delineated where the valleyline definitively crosses the flowline. If the flowline crosses the valleyline and then crosses back over in a short distance, this is not considered a definitive crossing. A definitive crossing is one where the flowline approaches the valleyline, crosses it, and then continues to move away from the valleyline for a significant longitudinal distance. Loops must alternate from one bank to the opposite bank. For example, if loop 1 is delineated along the right descending bank, then loop 2 is delineated along the left descending bank. Loops are composed of one or more bends (bends nest inside of loops). For example, loop 1 can have bends 1, 2, and 3 (i.e., loop 1, bend 1; loop 1, bend 2; loop 1, bend 3). Bend numbering restarts within each loop. The first bend value within a loop always begins with the value 1. Multiple Reaches: For a site with multiple reaches, loops must be uniquely numbered across all reaches. The loop field values of loop_points should not repeat within the reaches of a site. The downstream-most loop in the site should be numbered starting with the loop field value of 1 and increase moving upstream. Set the loop field value for each upstream reach to the upstream-most value (i.e., the highest loop value of the downstream reachs loop_points FC) of the downstream reach. For example, set the value of the field loop of the first Reach-2 loop_points feature to 8 if the maximum value of Reach-1s loop_points FC loop field is 7. Check Loop Points: Use the Check Loop Points tool in the Check toolset to verify that loops and bends are defined correctly. Review the messages produced by this tool to identify and correct problems with loop and bend delineation. 7.2.2 Derive Bankline Points The purpose of this step is to convert the banklines to a set of points and assign elevations and loop and bend locations. Use the 14b - Bankline Points tool to assign loops, bends, elevations and valley line positions to bankline points. When the tool completes, check that this tools runs correctly by running the Check Bankline Points tool in the Check toolset. The check tool ensures that the loop, bend, position, valley_POINT_X, valley_POINT_Y, and valley_POINT_M fields are populated. Only bankline_points features within loops and bends will have values in the loop, bend, and position fields. All records should have values in the valley_POINT_X, valley_POINT_Y, and valley_POINT_M fields. Additionally, apply the following definition query to the bankline_points feature class: loop IS NOT NULL. Only bankline_points features between loop_points features should be visible. 7.2.3 Assign Cross Section Loops The purpose of this step is to assign loop and bend identifiers to regularly spaced and riffle cross section FCs for each reach. Use the 14c - Assign Loops tool to assign loops and bends to a cross section FC. Set the value of the cross_section parameter to the regular cross section FC. After the tool completes, check the cross section FC that the loop and bend fields are assigned the correct loop and bend values. Repeat this step for both the riffle_channel and riffle_floodplain feature classes. 7.3 Calculate L3 Cross Section Geometry The purpose of this stage is to calculate the Level 3 dimensions for each reach. 7.3.1 Calculate Cross Section L3 Dimensions The purpose of this step is to calculate the L3 dimensions for the regularly spaced and riffle cross section FCs for each reach. If any *_dims_L3 FCs exist in the reach geodatabase (created during a previous run), delete these FCs. Use the 15c - XS Planform, Level 3 tool to calculate the L3 dimensions. Verify in the attribute table that the L3 dimensions have been calculated. 7.4 Run Report The purpose of this stage is to run the Level 3 report for each reach. 7.4.1 Run the L3 Report The purpose of this step is to run the L2 report for each reach. In the Reports toolset, use the Level 3 Report tool to produce the Level 3 Report. For the stream parameter, use the value of the ReachName field used in the flowline FC. For the flowline_fc parameter, enter the flowline FC for the base year survey. For the xs_dims_fc parameter, use the *_dims_L3 FC calculated for the regular cross sections of the base year. The xs_points_* parameters should be entered with the FC for the most recent survey first (i.e., the base year) and then the previous surveys in reverse chronological order (e.g., 2016, 2010, 2006). The survey_name_* parameters are used to label the surveys in maps and graphs. The FCs and labels used for the flowline_points_*, xs_points_*, and survey_name_* parameters must be entered in the same order (e.g., 2016, 2010, 2006) in each set of numbered parameters. For the dem parameter, enter the DEM for the base year survey. For the banklines_fc parameter, enter the banklines FC created for the base year survey. For the features_fc parameter, enter the features FC for the base year survey. For the bf_estimate parameter, specify the detrended elevation value that represents the bankfull water surface elevation. For the regions parameter, select the regions to use for estimating the bankfull water surface elevation. 7.4.2 Perform QA The purpose of this step is to use the QA Checklist to verify the reports have run correctly and identify any data mistakes that need to be corrected. Follow the instructions in the QA Checklist Chapter, Level 3 Report section, to verify that the reports have run correctly. Make the required changes suggested in the QA Checklist and rerun the report. Repeat these QA iterations until the reports are correct. 7.5 Determine Next Steps The purpose of this step is to determine what further steps need to be taken. Review the results of the Level 3 Report and determine if the project goals require further analysis. "],["summary.html", "Chapter 8 Summary", " Chapter 8 Summary The concluding chapter is the last chapter in the main body of the report before the reference list. The title and content may vary depending on the project type and audience. The chapter is usually called Summary, Conclusions, or Conclusions and Recommendations. A technical report may conclude with a summary chapter if its purpose is to document empirical observations or straightforward research findings such as the results of a field demonstration or a laboratory test series. A summary typically reviews the research results in more detail than the abstract. A chapter of conclusions differs from a summary chapter in that it presents or reviews the authors technical interpretation of the research results. Conclusions concisely help the reader to understand how the research objective was met and what the results mean in terms of the Army problem described in the background section. Conclusions should be included for every secondary objective stated in the introductory chapter. Most reports will include recommendations for the project sponsor. Recommendations generally will pertain to (1) how the research product or results should be used to address the problem defined in the first chapter or (2) what the sponsor may do to transition a technology product into advanced development, field demonstration, or commercialization. "],["qa-checklist.html", "QA Checklist 8.1 Level 1 Report 8.2 Estimate Bankfull Report 8.3 Level 2 Report 8.4 Level 3 Report", " QA Checklist This chapter describes the items an analyst needs to check to ensure that the FluvialGeomorph tools have run correctly to produce clean reports. In addition to following the guidance in the previous chapters when preparing the data and running each tool, this chapter will provide a checklist of items youll need to verify after each report completes. Reports are the place where all your hard work comes together! Your work is not complete just because the tools run without any errors. A lot of datasets must work together to make these reports come out cleanly. Because these reports integrate so many individual datasets, many issues arent discovered until you run the reports. This checklist will help you identify where things might not be exactly right with previous tool runs and what youll need to do fix them. 8.1 Level 1 Report 8.1.1 Study Area Overview This report section contains a set of reach overview maps drawn using the flowline and the regular cross section dimensions, \"_dims_L1\", feature classes (fc). Both the aerial photo and elevation are provided by Mapbox Raster Tiles. 8.1.1.1 Check the stream name All of the tools depend on consistent reach naming! Ensuring consistent naming begins with deriving the flowline fc. The ReachName field must contain the same value for all of the fcs within a reach geodatabase. This is the single biggest gotcha we find running these tools. If tools arent working correctly and youre sure youve done everything else right, consistent stream names is the first thing to check! 8.1.1.2 Cross section labels at the correct interval Cross section labels usually cannot be placed on every cross section or the map or graph becomes unreadable due to label crowding. The xs_label_freq parameter can be adjusted to adequately space cross section labels. Typically xs_label_freq = 10 works for regularly spaced cross sections and xs_label_freq = 2 works for riffle cross sections. 8.1.1.3 Cross sections cover the full extent of the flowine The flowline fc extends from the downstream end of the reach to the upstream end. Cross sections should be spaced regularly across the entire reach, without any gaps at the upper or lower end. 8.1.1.4 Map basemap displaying correctly The overview maps should contain an aerial photo or shaded relief elevation basemap. 8.1.2 Longitudinal Profiles This report section contains two longitudinal profile graphs, one drawn using the flowline_points fc, and the second is drawn using the cross section dimensions, \"_dims_L1\" fc. 8.1.2.1 Elevation values are reasonable The elevation values displayed on the map or graph should be reasonable. Use the Explore tool to check the DEM elevation values. By convention in FluvialGeomorph, DEM values must always have vertical units = feet. 8.1.2.2 Elevation ranges are similar between surveys Although stream elevations can change over time, the elevation ranges between subsequent survey dates should be roughly similar. If the elevation ranges are drastically different, check the terrain development steps for each survey time period to ensure that the elevation data was processed correctly. 8.1.2.3 Multiple surveys are labeled correctly Reports that contain multiple surveys should be entered in the same way to ensure they are labeled and symbolized (e.g., each survey drawn with the same color in each report) the same way across all reports. Follow these guidelines to ensure consistency: Most recent survey listed at the top, with earlier surveys listed in reverse chronologic order. Survey date indicates the date flown (e.g., not the contract or delivery date). 8.1.2.4 Multiple surveys are correctly calibrated to the base year On the longitudinal profile graphs, each survey line should start and end at the same x-axis station value. In other words, one survey line should not end before or after another survey line. Check the far right edge of the longitudinal graph to ensure all surveys have the same ending value. If all of the surveys last station values do not align, it means that the previous surveys were not correctly calibrated to the base year flowline. Previous year surveys will need to have the Flowline Points tool rerun using the base year surveys flowline_points for calibration. 8.1.2.5 Stationing in the correct units Units can be chosen for the longitudinal profile stationing. Ensure that the correct units are selected. 8.1.2.6 Stream feature labels display correctly Longitudinal graphs are labeled using the rows in the features fc. Ensure these river features are labeled correctly and are located at the correct longitudinal position. 8.1.3 Cross Section Metrics This report section contains a Level 1 cross section metrics plot drawn using the cross section dimensions fc, \"_dims_L1\". 8.1.3.1 Cross section watershed area calculated correctly The watershed area metric is calculated by the XS Watershed Area tool. Given the complexities of automatically calculating watershed area for high resolution stream features, some watershed areas may not have been calculated correctly. Rerunning the Watershed Area tool or manual adjustment of the Watershed_Area_SqMile field may be required. Watershed values are reasonable. Watershed area must increase moving downstream. 8.1.3.2 Elevation smoothing is acceptable High resolution LiDAR derived stream elevations can be noisy. Smoothing the elevations longitudinally is a way reduce noise. However, too much smoothing can be applied, eliminating any of the relationships we want to observe. By visually comparing the raw elevation and the smoothed elevation graphs, verify that the amount of smoothing sufficiently reduces noise, but does not not go too far and removes substantive variation. Smoothing is controlled in the XS Dimension tools using the loess_span parameter. 8.1.3.3 Ensure metrics values are smooth Many reach metrics are calculated using a longitudinal moving window analysis. The size of the moving window is controlled in the XS Dimensions tools using the lead_n parameter. A smaller value applies a narrower moving mindow and a larger value applies a wider moving window. If the moving window is too small, metric values will be highly variable along the stream. As the moving window size gets larger, metric value variation will be reduced. 8.1.3.4 Slope values are reasonable Slope values should be greater than zero. If negative slopes are being recorded, it usually means that the moving window size needs to be increased. 8.1.3.5 Sinuosity values are reasonable Sinuosity values should be greater than one. 8.1.4 Cross Section Profiles This report section contains a cross section map and a cross section profile graph for each cross section in the reach. The map is drawn from the cross section dimensions \"_dims_L1\" fc and the dem_hydro raster. The cross section profile graph is drawn using the cross section points fcs for each survey. 8.1.4.1 Cross section must be digitized from left to right The graph is being viewed from the perspective of standing in the stream, looking downstream. To ensure this orientation, cross sections must be digitized from the left descending bank to the right descending bank. 8.1.4.2 Cross section perpenduicular to the channel 8.1.4.3 Cross section covers the channel extent 8.1.4.4 Cross section extends onto floodplain 8.1.4.5 Cross section not located on built infrastructure 8.1.4.6 Cross section drawn within the DEM extent 8.1.4.7 Cross section y-axis range is not too large 8.1.4.8 Cross section x-axis range is not too large 8.2 Estimate Bankfull Report 8.2.1 Study Area Overview This report section contains a set of reach overview maps drawn using the flowline and the riffle cross section dimensions, \"_dims_L2\", feature classes (fc). Both the aerial photo and elevation are provided by Mapbox Raster Tiles. See the QA checklist items in the Level 1 Report, Study Area Overview section. 8.2.2 Bankfull Elevation Sensitivity Analysis This report section contains the Bankfull Elevation sensitivity analysis Goodness of Fit graph and the Regional Hydraulic Geometry Curves graph drawn using the base years riffle cross section points fc. 8.2.2.1 Correct regions included 8.2.2.2 Adequate range of bankfull elevations 8.2.2.3 Detrended bankfull elevation set to a reasonable value 8.2.2.4 Drainage Area values are reasonable 8.2.3 Longitudinal Profile This section of the report contains a cross section longitudinal profile graph drawn using the riffle cross section dimensions, riffle_channel_dims_L2 fc. 8.2.3.1 Elevation values are reasonable 8.2.3.2 Stationing in the correct units 8.2.3.3 Stream feature labels display correctly 8.2.4 Cross Section Metrics This report section contains a Level 2 cross section metrics plot drawn using the riffle_channel_dims_L2 fc. 8.2.4.1 Width-Depth Ratio values are reasonable 8.2.4.2 Entrenchment Ratio values are reasonable 8.2.4.3 Slope values are reasonable 8.2.4.4 Sinuosity values are reasonable 8.2.4.5 Shear Stress values are reasonable 8.2.4.6 Unit Stream Power values are reasonable 8.2.5 Cross Section Profiles This report section contains a cross section map and a cross section profile graph for each cross section in the reach. The map is drawn from the cross section dimensions fc riffle_channel_dims_L2 and the dem_hydro raster. The cross section profile graph is drawn using the riffle_channel_points fcs for each survey. see the QA checklist items in the Level 1 Report, Cross Section Profiles section. 8.3 Level 2 Report 8.3.1 Study Area Overview This report section contains a set of reach overview maps drawn using the flowline and the regular cross section dimensions, \"_dims_L2\", feature classes (fc). Both the aerial photo and elevation are provided by Mapbox Raster Tiles. See the QA checklist items in the Level 1 Report, Study Area Overview section. 8.3.2 Longitudinal Profile This section of the report contains a cross section longitudinal profile graph drawn using the regular cross section dimensions, \"_dims_L2\" fc. See the QA checklist items in the Estimate Bankfull, Longitudinal Profile section. 8.3.3 Cross Section Metrics This report section contains a Level 2 cross section metrics plot drawn using the regular cross section dimensions, \"_dims_L2\" fc.See the QA checklist items in the Estimate Bankfull, Cross section Metrics section. 8.3.3.1 Ensure metrics values are smooth 8.3.4 Cross Section Profiles This report section contains a cross section map and a cross section profile graph for each cross section in the reach. The map is drawn from the regular cross section dimensions fc \"_dims_L2\" and the dem_hydro raster. The cross section profile graph is drawn using the cross section \"_points\" fcs for each survey. see the QA checklist items in the Level 1 Report, Cross Section Profiles section. 8.4 Level 3 Report 8.4.1 Study Area Overview This report section contains a set of reach overview maps drawn using the flowline and the regular cross section dimensions, \"_dims_L3\", feature classes (fc). Both the aerial photo and elevation are provided by Mapbox Raster Tiles. See the QA checklist items in the Level 1 Report, Study Area Overview section. 8.4.2 Longitudinal Profile This section of the report contains a cross section longitudinal profile graph drawn using the regular cross section dimensions, \"_dims_L3\" fc. See the QA checklist items in the Estimate Bankfull, Longitudinal Profile section. 8.4.3 Cross Section Metrics This report section contains a Level 2 cross section metrics plot drawn using the regular cross section dimensions, \"_dims_L3\" fc.See the QA checklist items in the Estimate Bankfull, Cross section Metrics section. 8.4.3.1 Ensure metrics values are smooth 8.4.3.2 Radius of Curvature to Bankfull Width values are reasonable 8.4.4 Cross Section Profiles This report section contains a cross section map and a cross section profile graph for each cross section in the reach. The map is drawn from the regular cross section dimensions fc \"_dims_L3\" and the dem_hydro raster. The cross section profile graph is drawn using the cross section \"_points\" fcs for each survey. see the QA checklist items in the Level 1 Report, Cross Section Profiles section. "],["references.html", "References", " References "]]
